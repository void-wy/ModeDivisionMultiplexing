///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////

#include "CCD.H"

#include "CGVidEx.h"

///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////

//返回CCD拍摄的图像
IplImage * CCD::getImageCCD()
{
	return imageCCD;
}

//采集一帧图像
void CCD::snapShot()
{
	status = CGSnapShot(hcg, 0, 0, TRUE, 1);

	CG_VERIFY(status);

	if(CG_SUCCESS(status))
	{
		status = CGStaticMemLock(0, 768 * 576, &handle, (VOID **)&pStaticBuffer);

		if(CG_SUCCESS(status))
		{
			CGDataTransform(pImageBuffer, pStaticBuffer, 768, 576, 8, FALSE);
		}

		CGStaticMemUnlock(handle);
	}

	imageCCD->imageData = (char *)pImageBuffer;
}

//显示CCD拍摄的图像
void CCD::showImage()
{
	cvShowImage("Image_CCD", imageCCD);

	cvWaitKey(1);
}

///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////